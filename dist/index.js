!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.ReactWhiteboard=e(require("react")):t.ReactWhiteboard=e(t.react)}(window,function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(e,n){e.exports=t},function(t,e,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var h=10;function p(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function u(t,e,n,r){var o,i,s,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=p(t))>0&&s.length>o&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=s.length,a=h,console&&console.warn&&console.warn(a)}return t}function c(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,i(this.listener,this.target,t))}.bind(r);return o.listener=n,r.wrapFn=o,o}function f(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):l(o,o.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function l(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");h=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return p(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var h=o[t];if(void 0===h)return!1;if("function"==typeof h)i(h,this,e);else{var p=h.length,u=l(h,p);for(n=0;n<p;++n)i(u[n],this,e)}return!0},a.prototype.addListener=function(t,e){return u(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return u(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,c(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,c(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,o,i,s;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return f(this,t,!0)},a.prototype.rawListeners=function(t){return f(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){"use strict";var r,o;n.r(e),function(t){t.HAND="HAND",t.DRAW_LINE="DRAW_LINE",t.DRAG_IMAGE="DRAG_IMAGE",t.NW_RESIZE_IMAGE="NW_RESIZE_IMAGE",t.NE_RESIZE_IMAGE="NE_RESIZE_IMAGE",t.SE_RESIZE_IMAGE="SE_RESIZE_IMAGE",t.SW_RESIZE_IMAGE="SW_RESIZE_IMAGE"}(r||(r={})),function(t){t.LINE="LINE",t.IMAGE="IMAGE"}(o||(o={}));var i,s=n(0),a=n(1),h=n.n(a);!function(t){t.SELECT_LAYER="selectLayer",t.ADD_LAYER="addLayer",t.START="start",t.STOP="stop",t.SET="set",t.PUSH="push",t.PASTE="paste",t.START_DRAGGING="startDragging",t.STOP_DRAGGING="stopDragging",t.DRAG="drag",t.START_RESIZING="startResizing",t.STOP_RESIZING="stopResizing",t.RESIZE="resize",t.UNDO="undo",t.REDO="redo",t.CLEAR="clear"}(i||(i={}));var p,u=function(){function t(){this.emitter=new h.a}return t.prototype.on=function(t,e){this.emitter.on(t,e)},t.prototype.selectLayer=function(t){this.emitter.emit("selectLayer",t)},t.prototype.addLayer=function(){this.emitter.emit("addLayer")},t.prototype.startDrawing=function(t,e){this.emitter.emit("start",{x:t,y:e})},t.prototype.stopDrawing=function(){this.emitter.emit("stop")},t.prototype.changeStrokeWidth=function(t){var e={key:"strokeWidth",value:t};this.emitter.emit("set",e)},t.prototype.changeStrokeColor=function(t){var e={key:"strokeColor",value:t};this.emitter.emit("set",e)},t.prototype.pushPoint=function(t,e){var n={x:t,y:e};this.emitter.emit("push",n)},t.prototype.pasteImage=function(t,e,n,r,o){var i={x:t,y:e,width:n,height:r,dataUrl:o};this.emitter.emit("paste",i)},t.prototype.startDragging=function(){this.emitter.emit("startDragging")},t.prototype.stopDragging=function(){this.emitter.emit("stopDragging")},t.prototype.dragImage=function(t,e){var n={x:t,y:e};this.emitter.emit("drag",n)},t.prototype.startResizing=function(t){this.emitter.emit("startResizing",t)},t.prototype.stopResizing=function(){this.emitter.emit("stopResizing")},t.prototype.resizeImage=function(t,e){var n={x:t,y:e};this.emitter.emit("resize",n)},t.prototype.undo=function(){this.emitter.emit("undo")},t.prototype.redo=function(){this.emitter.emit("redo")},t.prototype.clear=function(){this.emitter.emit("clear")},t}(),c=function(t){return t.type===o.LINE},f=function(t){return t.type===o.IMAGE},d=function(t){return t.type===o.LINE},l=function(t){return t.type===o.IMAGE},v=function(){function t(){this.selectedLayer=0,this.renderableLayers=[!0],this.goodEvents=[],this.undoEvents=[]}return t.prototype.lastImage=function(){var t=this.goodEvents[this.goodEvents.length-1];return t&&f(t)?t.image:null},t.prototype.reduceEvents=function(){var t=this;return this.goodEvents.reduce(function(t,e){if(!e.type)return t.forEach(function(t){t.push({})}),t;if(c(e)){var n=t[e.layer][t[e.layer].length-1];if(n&&d(n)&&n.strokeWidth===e.strokeWidth&&n.strokeColor===e.strokeColor)n.values.push(e.point);else{var r={type:e.type,strokeWidth:e.strokeWidth,strokeColor:e.strokeColor,values:[e.point]};t[e.layer].push(r)}return t}if(f(e)){var o={type:e.type,image:e.image};return t[e.layer].push(o),t}return t},this.renderableLayers.map(function(){return[]})).filter(function(e,n){return t.renderableLayers[n]}).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return d(t)?t.values.length>1:(l(t),!0)})},t.prototype.selectLayer=function(t){this.goodEvents.push({type:null}),this.selectedLayer=t},t.prototype.addLayer=function(){this.renderableLayers.push(!0)},t.prototype.startDrawing=function(t,e,n){this.goodEvents.push({type:o.LINE,layer:this.selectedLayer,strokeWidth:t,strokeColor:e,point:n})},t.prototype.stopDrawing=function(){this.goodEvents.push({type:null})},t.prototype.pushPoint=function(t,e,n){var r={type:o.LINE,layer:this.selectedLayer,strokeWidth:t,strokeColor:e,point:n};this.goodEvents.push(r),this.undoEvents=[]},t.prototype.pasteImage=function(t){var e={type:o.IMAGE,layer:this.selectedLayer,image:t};this.goodEvents.push(e),this.undoEvents=[]},t.prototype.dragImage=function(t){var e=this.lastImage();e&&(e.x=e.x+t.x,e.y=e.y+t.y)},t.prototype.nwResizeImage=function(t){var e=this.lastImage();e&&(e.x=e.x+t.x,e.y=e.y+t.y,e.width=e.width-t.x,e.height=e.height-t.y)},t.prototype.neResizeImage=function(t){var e=this.lastImage();e&&(e.y=e.y+t.y,e.width=e.width+t.x,e.height=e.height-t.y)},t.prototype.seResizeImage=function(t){var e=this.lastImage();e&&(e.width=e.width+t.x,e.height=e.height+t.y)},t.prototype.swResizeImage=function(t){var e=this.lastImage();e&&(e.x=e.x+t.x,e.width=e.width-t.x,e.height=e.height+t.y)},t.prototype.undo=function(){this.goodEvents.length&&(this.undoEvents.push(this.goodEvents.pop()),this.undoEvents.push(this.goodEvents.pop()),this.goodEvents.push({type:null}))},t.prototype.redo=function(){this.undoEvents.length&&(this.goodEvents.pop(),this.goodEvents.push(this.undoEvents.pop()),this.goodEvents.push(this.undoEvents.pop()))},t.prototype.clear=function(){this.goodEvents=[],this.undoEvents=[]},t}(),g=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t){function e(e){var n=t.call(this,e)||this;return n.state={dragStart:null,resizeStart:null},n}return g(e,t),e.prototype.onClickCursorLayer=function(t){var e=this;if(this.props.mode===r.HAND){var n=function(t){return[t.nativeEvent.offsetX-2,t.nativeEvent.offsetY+e.props.strokeWidth/3*2]}(t),o=n[0],i=n[1];this.props.events.startDrawing(o,i)}else this.props.events.stopDrawing()},e.prototype.onMouseMoveCursorLayer=function(t){var e=this;if(this.props.mode===r.DRAW_LINE){var n=function(t){return[t.nativeEvent.offsetX-2,t.nativeEvent.offsetY+e.props.strokeWidth/3*2]}(t),o=n[0],i=n[1];this.props.events.pushPoint(o,i)}else if(this.props.mode===r.DRAG_IMAGE){if(t.target!==this.dragHandle)return;if(!(u=this.props.eventStore.lastImage()))return;if(this.state.dragStart){var s=u.width<u.height?u.width:u.height,a=s/8<20?Math.ceil(s/8):20,h=u.x+a<0?t.nativeEvent.offsetX-this.state.dragStart.x-(u.x+a):t.nativeEvent.offsetX-this.state.dragStart.x,p=u.y+a<0?t.nativeEvent.offsetY-this.state.dragStart.y-(u.y+a):t.nativeEvent.offsetY-this.state.dragStart.y;this.props.events.dragImage(h,p)}}else if(this.props.mode===r.NW_RESIZE_IMAGE||this.props.mode===r.NE_RESIZE_IMAGE||this.props.mode===r.SE_RESIZE_IMAGE||this.props.mode===r.SW_RESIZE_IMAGE){var u;if(!(u=this.props.eventStore.lastImage()))return;if(this.state.resizeStart){h=t.pageX-this.state.resizeStart.x,p=t.pageY-this.state.resizeStart.y;if(this.props.mode===r.NW_RESIZE_IMAGE&&(u.width-h<0||u.height-p<0))return;if(this.props.mode===r.NE_RESIZE_IMAGE&&(u.width+h<0||u.height-p<0))return;if(this.props.mode===r.SE_RESIZE_IMAGE&&(u.width+h<0||u.height+p<0))return;if(this.props.mode===r.SW_RESIZE_IMAGE&&(u.width-h<0||u.height+p<0))return;this.setState({resizeStart:{x:t.pageX,y:t.pageY}}),this.props.events.resizeImage(h,p)}}},e.prototype.onClickDragHandle=function(t){this.props.mode===r.HAND?(this.setState({dragStart:{x:t.nativeEvent.offsetX,y:t.nativeEvent.offsetY}}),this.props.events.startDragging()):(this.setState({dragStart:null}),this.props.events.stopDragging()),t.preventDefault(),t.stopPropagation()},e.prototype.onClickResizeHandle=function(t,e){this.props.mode===r.HAND?(this.setState({resizeStart:{x:e.pageX,y:e.pageY}}),this.props.events.startResizing(t)):(this.setState({resizeStart:null}),this.props.events.stopResizing()),e.preventDefault(),e.stopPropagation()},e.prototype.render=function(){var t={position:"absolute",zIndex:2e3,width:this.props.width,height:this.props.height,borderStyle:"none none solid none",borderColor:this.props.strokeColor};return s.createElement("div",{role:"presentation",style:t,onClick:this.onClickCursorLayer.bind(this),onMouseMove:this.onMouseMoveCursorLayer.bind(this)},this.renderImageHandle())},e.prototype.renderImageHandle=function(){var t=this,e=this.props.eventStore.lastImage();if(!e)return null;var n=e.width<e.height?e.width:e.height,o=n/8<20?Math.ceil(n/8):20,i=function(t,e,n){return n<t?t:n>e?e:n},a=i(0,this.props.height,e.y+o),h=i(0,this.props.height,e.y+e.height-o),p=i(0,this.props.width,e.x+o),u=i(0,this.props.width,e.x+e.width-o),c={position:"absolute",zIndex:2500,top:a,left:p,width:u-p,height:h-a,cursor:"move"},f={position:"absolute",zIndex:2500,top:i(0,this.props.height,a-o),left:i(0,this.props.width,p-o),width:p-i(0,this.props.width,p-o),height:a-i(0,this.props.height,a-o),cursor:"nw-resize"},d={position:"absolute",zIndex:2500,top:i(0,this.props.height,a-o),left:u,width:i(0,this.props.width,u+o)-u,height:a-i(0,this.props.height,a-o),cursor:"ne-resize"},l={position:"absolute",zIndex:2500,top:h,left:u,width:i(0,this.props.width,u+o)-u,height:i(0,this.props.height,h+o)-h,cursor:"se-resize"},v={position:"absolute",zIndex:2500,top:h,left:i(0,this.props.width,p-o),width:p-i(0,this.props.width,p-o),height:i(0,this.props.height,h+o)-h,cursor:"sw-resize"};return[s.createElement("div",{key:"drag",role:"presentation",style:c,ref:function(e){return t.dragHandle=e},onClick:this.onClickDragHandle.bind(this)}),s.createElement("div",{key:"nw-resize",role:"presentation",style:f,onClick:this.onClickResizeHandle.bind(this,r.NW_RESIZE_IMAGE)}),s.createElement("div",{key:"ne-resize",role:"presentation",style:d,onClick:this.onClickResizeHandle.bind(this,r.NE_RESIZE_IMAGE)}),s.createElement("div",{key:"se-resize",role:"presentation",style:l,onClick:this.onClickResizeHandle.bind(this,r.SE_RESIZE_IMAGE)}),s.createElement("div",{key:"sw-resize",role:"presentation",style:v,onClick:this.onClickResizeHandle.bind(this,r.SW_RESIZE_IMAGE)})]},e}(s.Component),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(t){function e(e){var n=t.call(this,e)||this;return n.svgElement=null,n}return m(e,t),e.prototype.getSvgElement=function(){return this.svgElement},e.prototype.render=function(){var t=this,e={position:"absolute",width:this.props.width,height:this.props.height};return s.createElement("div",{style:e},s.createElement("svg",{ref:function(e){return t.svgElement=e},version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:this.props.width,height:this.props.height},s.createElement("rect",{width:"100%",height:"100%",fill:this.props.style.backgroundColor}),this.drawWhiteboardCanvas(),this.drawImageBorder()))},e.prototype.drawWhiteboardCanvas=function(){return this.props.eventStore.reduceEvents().map(function(t,e){if(d(t)){var n=e,r=t.values.map(function(t,e){return 0===e?"M "+t.x+" "+t.y:"L "+t.x+" "+t.y});return s.createElement("path",{key:n,d:r.join(" "),fill:"none",stroke:t.strokeColor,strokeWidth:t.strokeWidth})}if(l(t)){n=e;var o=t.image;return s.createElement("image",{key:n,x:o.x,y:o.y,width:o.width,height:o.height,xlinkHref:o.dataUrl})}return null})},e.prototype.drawImageBorder=function(){var t=this.props.eventStore.lastImage();return t?s.createElement("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:"none",stroke:"black",strokeDasharray:"5,5"}):null},e}(s.Component),S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(){return(w=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},I=function(t){function e(e){var n=t.call(this,e)||this;return n.state={eventStore:e.eventStore,mode:r.HAND,layer:0,strokeWidth:5,strokeColor:"black"},n.canvas=null,n}return S(e,t),e.prototype.getSvgElement=function(){if(this.canvas)return this.canvas.getSvgElement()},e.prototype.componentDidMount=function(){this.setupEventHandler()},e.prototype.setupEventHandler=function(){var t=this;this.props.events.on(i.SELECT_LAYER,this.selectLayer.bind(this)),this.props.events.on(i.ADD_LAYER,this.addLayer.bind(this)),this.props.events.on(i.START,this.startDrawing.bind(this)),this.props.events.on(i.STOP,this.stopDrawing.bind(this)),this.props.events.on(i.SET,function(e){"strokeWidth"===e.key&&t.changeStrokeWidth(e.value),"strokeColor"===e.key&&t.changeStrokeColor(e.value)}),this.props.events.on(i.PUSH,this.pushPoint.bind(this)),this.props.events.on(i.PASTE,this.pasteImage.bind(this)),this.props.events.on(i.START_DRAGGING,this.startDragging.bind(this)),this.props.events.on(i.STOP_DRAGGING,this.stopDragging.bind(this)),this.props.events.on(i.DRAG,this.dragImage.bind(this)),this.props.events.on(i.START_RESIZING,this.startResizing.bind(this)),this.props.events.on(i.STOP_RESIZING,this.stopResizing.bind(this)),this.props.events.on(i.RESIZE,this.resizeImage.bind(this)),this.props.events.on(i.UNDO,this.undo.bind(this)),this.props.events.on(i.REDO,this.redo.bind(this)),this.props.events.on(i.CLEAR,this.clear.bind(this))},e.prototype.selectLayer=function(t){this.state.eventStore.selectLayer(t),this.setState({layer:t,eventStore:this.state.eventStore})},e.prototype.addLayer=function(){this.state.eventStore.addLayer(),this.setState({eventStore:this.state.eventStore})},e.prototype.startDrawing=function(t){this.state.eventStore.startDrawing(this.state.strokeWidth,this.state.strokeColor,t),this.setState({mode:r.DRAW_LINE,eventStore:this.state.eventStore})},e.prototype.stopDrawing=function(){this.state.eventStore.stopDrawing(),this.setState({mode:r.HAND,eventStore:this.state.eventStore})},e.prototype.changeStrokeWidth=function(t){this.state.eventStore.stopDrawing(),this.setState({strokeWidth:t,eventStore:this.state.eventStore})},e.prototype.changeStrokeColor=function(t){this.state.eventStore.stopDrawing(),this.setState({strokeColor:t,eventStore:this.state.eventStore})},e.prototype.pushPoint=function(t){this.state.eventStore.pushPoint(this.state.strokeWidth,this.state.strokeColor,t),this.setState({eventStore:this.state.eventStore})},e.prototype.pasteImage=function(t){this.state.eventStore.pasteImage(t),this.setState({eventStore:this.state.eventStore})},e.prototype.startDragging=function(){this.setState({mode:r.DRAG_IMAGE})},e.prototype.stopDragging=function(){this.setState({mode:r.HAND})},e.prototype.dragImage=function(t){this.state.mode===r.DRAG_IMAGE&&(this.state.eventStore.dragImage(t),this.setState({eventStore:this.state.eventStore}))},e.prototype.startResizing=function(t){this.setState({mode:t})},e.prototype.stopResizing=function(){this.setState({mode:r.HAND})},e.prototype.resizeImage=function(t){this.state.mode===r.NW_RESIZE_IMAGE?(this.state.eventStore.nwResizeImage(t),this.setState({eventStore:this.state.eventStore})):this.state.mode===r.NE_RESIZE_IMAGE?(this.state.eventStore.neResizeImage(t),this.setState({eventStore:this.state.eventStore})):this.state.mode===r.SE_RESIZE_IMAGE?(this.state.eventStore.seResizeImage(t),this.setState({eventStore:this.state.eventStore})):this.state.mode===r.SW_RESIZE_IMAGE&&(this.state.eventStore.swResizeImage(t),this.setState({eventStore:this.state.eventStore}))},e.prototype.undo=function(){this.state.eventStore.undo(),this.setState({eventStore:this.state.eventStore})},e.prototype.redo=function(){this.state.eventStore.redo(),this.setState({eventStore:this.state.eventStore})},e.prototype.clear=function(){this.state.eventStore.clear(),this.setState({eventStore:this.state.eventStore})},e.prototype.render=function(){var t=this,e={position:"relative",width:this.props.width,height:this.props.height},n=w(w({},this.props),this.state);return s.createElement("div",{style:e},s.createElement(y,w({},n)),s.createElement(E,w({ref:function(e){return t.canvas=e}},n)))},e.defaultProps={events:new u,eventStore:new v,width:400,height:400,style:{backgroundColor:"none"}},e}(s.Component),_=function(){function t(){}return t.toSvgData=function(t){var e=t.outerHTML,n=window.btoa(window.encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode(window.parseInt("0x"+e))}));return new Promise(function(t){t("data:image/svg+xml;charset=utf-8;base64,"+n)})},t.toPngData=function(e){return t.toDataUrl(e,"image/png")},t.toJpegData=function(e){return t.toDataUrl(e,"image/jpeg")},t.toDataUrl=function(e,n){return new Promise(function(r){t.toSvgData(e).then(function(t){var o=e.getBoundingClientRect(),i=o.width,s=o.height,a=new window.Image;a.onload=function(){var t=document.createElement("canvas");t.width=i,t.height=s;var e=t.getContext("2d");if(!e)throw new Error("got no rendering context");e.drawImage(a,0,0),r(t.toDataURL(n))},a.src=t})})},t.fromPngImage=function(e){return t.fromImageUrl(e,"image/png")},t.fromJpegImage=function(e){return t.fromImageUrl(e,"image/jpeg")},t.fromGifImage=function(e){return t.fromImageUrl(e,"image/gif")},t.fromImageUrl=function(t,e){return new Promise(function(n){var r=new window.Image;r.onload=function(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height;var o=t.getContext("2d");if(!o)throw new Error("got no rendering context");o.drawImage(r,0,0),n({width:r.width,height:r.height,dataUrl:t.toDataURL(e)})},r.crossOrigin="anonymous",r.src=t})},t}();n.d(e,"Whiteboard",function(){return I}),n.d(e,"EventNameEnum",function(){return i}),n.d(e,"EventStream",function(){return u}),n.d(e,"EventStore",function(){return v}),n.d(e,"isPointEvent",function(){return c}),n.d(e,"isImageEvent",function(){return f}),n.d(e,"isReducedImageEvent",function(){return l}),n.d(e,"isReducedLineEvent",function(){return d}),n.d(e,"SvgConverter",function(){return _}),n.d(e,"ModeEnum",function(){return r}),n.d(e,"SvgElementEnum",function(){return o})}])});
//# sourceMappingURL=index.js.map