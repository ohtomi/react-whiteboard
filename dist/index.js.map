{"version":3,"sources":["webpack://ReactWhiteboard/webpack/universalModuleDefinition","webpack://ReactWhiteboard/webpack/bootstrap","webpack://ReactWhiteboard/external \"react\"","webpack://ReactWhiteboard/./node_modules/events/events.js","webpack://ReactWhiteboard/./src/Constants.ts","webpack://ReactWhiteboard/./src/EventStream.ts","webpack://ReactWhiteboard/./src/EventStore.ts","webpack://ReactWhiteboard/./src/CursorPane.tsx","webpack://ReactWhiteboard/./src/CanvasPane.tsx","webpack://ReactWhiteboard/./src/Whiteboard.tsx","webpack://ReactWhiteboard/./src/SvgConverter.ts","webpack://ReactWhiteboard/./src/index.ts"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","this","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","$getMaxListeners","that","_addListener","type","listener","prepend","events","existing","warning","TypeError","newListener","emit","unshift","push","length","warned","w","Error","String","emitter","count","console","warn","_onceWrap","state","fired","wrapFn","wrapped","arguments","removeListener","_listeners","unwrap","evlistener","arr","ret","Array","unwrapListeners","arrayClone","listenerCount","copy","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","len","listeners","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","ModeEnum","SvgElementEnum","EventNameEnum","EventStream_EventStream","EventStream","events_default","a","selectLayer","layer","addLayer","startDrawing","x","y","stopDrawing","changeStrokeWidth","width","change","changeStrokeColor","color","pushPoint","point","pasteImage","height","dataUrl","image","startDragging","stopDragging","dragImage","move","startResizing","direction","stopResizing","resizeImage","undo","redo","clear","isPointEvent","LINE","isImageEvent","IMAGE","isReducedLineEvent","isReducedImageEvent","EventStore_EventStore","EventStore","selectedLayer","renderableLayers","goodEvents","undoEvents","lastImage","last","reduceEvents","_this","reduce","prev","element","forEach","strokeWidth","strokeColor","values","event_1","event_2","map","filter","event","nwResizeImage","neResizeImage","seResizeImage","swResizeImage","CursorPane_CursorPane","_super","CursorPane","props","dragStart","resizeStart","__extends","onClickCursorLayer","ev","HAND","_a","nativeEvent","offsetX","offsetY","eventToPoint","onMouseMoveCursorLayer","DRAW_LINE","DRAG_IMAGE","dragHandle","eventStore","base","unit","Math","ceil","moveX","moveY","NW_RESIZE_IMAGE","NE_RESIZE_IMAGE","SE_RESIZE_IMAGE","SW_RESIZE_IMAGE","pageX","pageY","setState","onClickDragHandle","preventDefault","stopPropagation","onClickResizeHandle","render","cursorLayerStyle","zIndex","borderStyle","borderColor","external_react_","role","style","onClick","onMouseMove","renderImageHandle","mathMinOrMax","min","max","top","bottom","left","right","dragHandleStyle","cursor","nwResizeHandleStyle","neResizeHandleStyle","seResizeHandleStyle","swResizeHandleStyle","ref","CanvasPane_CanvasPane","CanvasPane","svgElement","CanvasPane_extends","getSvgElement","canvasLayerStyle","version","xmlns","xmlnsXlink","fill","backgroundColor","drawWhiteboardCanvas","drawImageBorder","join","stroke","xlinkHref","strokeDasharray","Whiteboard_Whiteboard","Whiteboard","canvas","Whiteboard_extends","componentDidMount","setupEventHandler","SELECT_LAYER","ADD_LAYER","START","STOP","SET","PUSH","PASTE","START_DRAGGING","STOP_DRAGGING","DRAG","START_RESIZING","STOP_RESIZING","RESIZE","UNDO","REDO","CLEAR","wrapperStyle","__assign","defaultProps","SvgConverter","toSvgData","sourceNode","htmlText","outerHTML","base64EncodedText","btoa","encodeURIComponent","replace","match","p1","fromCharCode","parseInt","Promise","resolve","toPngData","toDataUrl","toJpegData","imageType","then","svgdata","getBoundingClientRect","imageNode","Image","onload","canvasNode","document","createElement","graphicsContext","getContext","drawImage","toDataURL","src","fromPngImage","imageUrl","fromImageUrl","fromJpegImage","fromGifImage","crossOrigin","__webpack_exports__"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReactWhiteboard\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"ReactWhiteboard\"] = factory(root[\"react\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","export enum ModeEnum {\n    HAND = 'HAND',\n    DRAW_LINE = 'DRAW_LINE',\n    DRAG_IMAGE = 'DRAG_IMAGE',\n    NW_RESIZE_IMAGE = 'NW_RESIZE_IMAGE',\n    NE_RESIZE_IMAGE = 'NE_RESIZE_IMAGE',\n    SE_RESIZE_IMAGE = 'SE_RESIZE_IMAGE',\n    SW_RESIZE_IMAGE = 'SW_RESIZE_IMAGE'\n}\n\nexport enum SvgElementEnum {\n    LINE = 'LINE',\n    IMAGE = 'IMAGE'\n}\n\nexport type ResizeImageDirection =\n    typeof ModeEnum.NW_RESIZE_IMAGE |\n    typeof ModeEnum.NE_RESIZE_IMAGE |\n    typeof ModeEnum.SE_RESIZE_IMAGE |\n    typeof ModeEnum.SW_RESIZE_IMAGE\n","import EventEmitter from 'events'\n\nimport {ResizeImageDirection} from './Constants'\nimport {ImageData, MouseMoveData, PointData} from './EventStore'\n\n\nexport type EventListener = (value: any) => void\n\nexport type ChangeStrokeWidth = {\n    key: 'strokeWidth',\n    value: number\n}\n\nexport type ChangeStrokeColor = {\n    key: 'strokeColor',\n    value: string\n}\n\nexport enum EventNameEnum {\n    SELECT_LAYER = 'selectLayer',\n    ADD_LAYER = 'addLayer',\n    START = 'start',\n    STOP = 'stop',\n    SET = 'set',\n    PUSH = 'push',\n    PASTE = 'paste',\n    START_DRAGGING = 'startDragging',\n    STOP_DRAGGING = 'stopDragging',\n    DRAG = 'drag',\n    START_RESIZING = 'startResizing',\n    STOP_RESIZING = 'stopResizing',\n    RESIZE = 'resize',\n    UNDO = 'undo',\n    REDO = 'redo',\n    CLEAR = 'clear'\n}\n\nexport interface EventStreamProtocol {\n\n    on(name: EventNameEnum, listener: EventListener): void\n\n    selectLayer(layer: number): void\n\n    addLayer(): void\n\n    startDrawing(x: number, y: number): void\n\n    stopDrawing(): void\n\n    changeStrokeWidth(width: number): void\n\n    changeStrokeColor(color: string): void\n\n    pushPoint(x: number, y: number): void\n\n    pasteImage(x: number, y: number, width: number, height: number, dataUrl: string): void\n\n    startDragging(): void\n\n    stopDragging(): void\n\n    dragImage(x: number, y: number): void\n\n    startResizing(direction: ResizeImageDirection): void\n\n    stopResizing(): void\n\n    resizeImage(x: number, y: number): void\n\n    undo(): void\n\n    redo(): void\n\n    clear(): void\n\n}\n\n\nexport class EventStream implements EventStreamProtocol {\n\n    emitter: EventEmitter\n\n    constructor() {\n        this.emitter = new EventEmitter()\n    }\n\n    on(name: EventNameEnum, listener: EventListener) {\n        this.emitter.on(name, listener)\n    }\n\n    selectLayer(layer: number) {\n        this.emitter.emit('selectLayer', layer)\n    }\n\n    addLayer() {\n        this.emitter.emit('addLayer')\n    }\n\n    startDrawing(x: number, y: number) {\n        this.emitter.emit('start', {x, y})\n    }\n\n    stopDrawing() {\n        this.emitter.emit('stop')\n    }\n\n    changeStrokeWidth(width: number) {\n        const change: ChangeStrokeWidth = {key: 'strokeWidth', value: width}\n        this.emitter.emit('set', change)\n    }\n\n    changeStrokeColor(color: string) {\n        const change: ChangeStrokeColor = {key: 'strokeColor', value: color}\n        this.emitter.emit('set', change)\n    }\n\n    pushPoint(x: number, y: number) {\n        const point: PointData = {x, y}\n        this.emitter.emit('push', point)\n    }\n\n    pasteImage(x: number, y: number, width: number, height: number, dataUrl: string) {\n        const image: ImageData = {x, y, width, height, dataUrl}\n        this.emitter.emit('paste', image)\n    }\n\n    startDragging() {\n        this.emitter.emit('startDragging')\n    }\n\n    stopDragging() {\n        this.emitter.emit('stopDragging')\n    }\n\n    dragImage(x: number, y: number) {\n        const move: MouseMoveData = {x, y}\n        this.emitter.emit('drag', move)\n    }\n\n    startResizing(direction: ResizeImageDirection) {\n        this.emitter.emit('startResizing', direction)\n    }\n\n    stopResizing() {\n        this.emitter.emit('stopResizing')\n    }\n\n    resizeImage(x: number, y: number) {\n        const move: MouseMoveData = {x, y}\n        this.emitter.emit('resize', move)\n    }\n\n    undo() {\n        this.emitter.emit('undo')\n    }\n\n    redo() {\n        this.emitter.emit('redo')\n    }\n\n    clear() {\n        this.emitter.emit('clear')\n    }\n}\n","import {SvgElementEnum} from './Constants'\n\n\nexport type PointData = {\n    x: number,\n    y: number\n}\n\nexport type ImageData = {\n    x?: number,\n    y?: number,\n    width: number,\n    height: number,\n    dataUrl: string\n}\n\nexport type MouseMoveData = {\n    x: number,\n    y: number\n}\n\nexport type PointEvent = {\n    type: typeof SvgElementEnum.LINE,\n    layer: number,\n    strokeWidth: number,\n    strokeColor: string,\n    point: PointData\n}\n\nexport type ImageEvent = {\n    type: typeof SvgElementEnum.IMAGE,\n    layer: number,\n    image: ImageData\n}\n\nexport type StopEvent = {\n    type: null\n}\n\nexport type AnyEvent = PointEvent | ImageEvent | StopEvent\n\nexport type ReducedLineEvent = {\n    type: typeof SvgElementEnum.LINE,\n    strokeWidth: number,\n    strokeColor: string,\n    values: Array<PointData>\n}\n\nexport type ReducedImageEvent = {\n    type: typeof SvgElementEnum.IMAGE,\n    image: ImageData\n}\n\nexport type ReducedStopEvent = {\n    type?: null\n}\n\nexport type AnyReducedEvent = ReducedLineEvent | ReducedImageEvent | ReducedStopEvent\n\nexport const isPointEvent = (arg: AnyEvent): arg is PointEvent => {\n    return arg.type === SvgElementEnum.LINE\n}\n\nexport const isImageEvent = (arg: AnyEvent): arg is ImageEvent => {\n    return arg.type === SvgElementEnum.IMAGE\n}\n\nexport const isReducedLineEvent = (arg: AnyReducedEvent): arg is ReducedLineEvent => {\n    return arg.type === SvgElementEnum.LINE\n}\n\nexport const isReducedImageEvent = (arg: AnyReducedEvent): arg is ReducedImageEvent => {\n    return arg.type === SvgElementEnum.IMAGE\n}\n\nexport interface EventStoreProtocol {\n\n    lastImage(): ImageData | undefined\n\n    reduceEvents(): Array<AnyReducedEvent>\n\n    selectLayer(layer: number): void\n\n    addLayer(): void\n\n    startDrawing(strokeWidth: number, strokeColor: string, point: PointData): void\n\n    stopDrawing(): void\n\n    pushPoint(strokeWidth: number, strokeColor: string, point: PointData): void\n\n    pasteImage(image: ImageData): void\n\n    dragImage(move: MouseMoveData): void\n\n    nwResizeImage(move: MouseMoveData): void\n\n    neResizeImage(move: MouseMoveData): void\n\n    seResizeImage(move: MouseMoveData): void\n\n    swResizeImage(move: MouseMoveData): void\n\n    undo(): void\n\n    redo(): void\n\n    clear(): void\n}\n\n\nexport class EventStore implements EventStoreProtocol {\n\n    selectedLayer: number\n    renderableLayers: Array<boolean>\n    goodEvents: Array<AnyEvent>\n    undoEvents: Array<AnyEvent>\n\n    constructor() {\n        this.selectedLayer = 0\n        this.renderableLayers = [true]\n        this.goodEvents = []\n        this.undoEvents = []\n    }\n\n    lastImage(): ImageData | undefined {\n        const last = this.goodEvents[this.goodEvents.length - 1]\n        if (last && isImageEvent(last)) {\n            return last.image\n        } else {\n            return null\n        }\n    }\n\n    reduceEvents(): Array<AnyReducedEvent> {\n        return this.goodEvents.reduce((prev: Array<Array<AnyReducedEvent>>, element: AnyEvent): Array<Array<AnyReducedEvent>> => {\n                if (!element.type) {\n                    prev.forEach(p => {\n                        p.push({})\n                    })\n                    return prev\n                }\n\n                if (isPointEvent(element)) {\n                    let last = prev[element.layer][prev[element.layer].length - 1]\n                    if (last && isReducedLineEvent(last) && last.strokeWidth === element.strokeWidth && last.strokeColor === element.strokeColor) {\n                        last.values.push(element.point)\n                    } else {\n                        const event: ReducedLineEvent = {\n                            type: element.type,\n                            strokeWidth: element.strokeWidth,\n                            strokeColor: element.strokeColor,\n                            values: [element.point]\n                        }\n                        prev[element.layer].push(event)\n                    }\n                    return prev\n\n                } else if (isImageEvent(element)) {\n                    const event: ReducedImageEvent = {\n                        type: element.type,\n                        image: element.image\n                    }\n                    prev[element.layer].push(event)\n                    return prev\n\n                } else {\n                    return prev\n                }\n\n            }, this.renderableLayers.map(() => [])\n        ).filter((element: Array<AnyReducedEvent>, index: number): boolean => {\n            return this.renderableLayers[index]\n\n        }).reduce((prev: Array<AnyReducedEvent>, element: Array<AnyReducedEvent>): Array<AnyReducedEvent> => {\n                return prev.concat(element)\n\n            }, []\n        ).filter((element: AnyReducedEvent): boolean => {\n            if (isReducedLineEvent(element)) {\n                return element.values.length > 1\n            } else if (isReducedImageEvent(element)) {\n                return true\n            } else {\n                return true\n            }\n        })\n    }\n\n    selectLayer(layer: number) {\n        this.goodEvents.push({type: null})\n        this.selectedLayer = layer\n    }\n\n    addLayer() {\n        this.renderableLayers.push(true)\n    }\n\n    startDrawing(strokeWidth: number, strokeColor: string, point: PointData) {\n        this.goodEvents.push({\n            type: SvgElementEnum.LINE,\n            layer: this.selectedLayer,\n            strokeWidth: strokeWidth,\n            strokeColor: strokeColor,\n            point: point\n        })\n    }\n\n    stopDrawing() {\n        this.goodEvents.push({type: null})\n    }\n\n    pushPoint(strokeWidth: number, strokeColor: string, point: PointData) {\n        const event: PointEvent = {\n            type: SvgElementEnum.LINE,\n            layer: this.selectedLayer,\n            strokeWidth: strokeWidth,\n            strokeColor: strokeColor,\n            point: point\n        }\n        this.goodEvents.push(event)\n        this.undoEvents = []\n    }\n\n    pasteImage(image: ImageData) {\n        const event: ImageEvent = {\n            type: SvgElementEnum.IMAGE,\n            layer: this.selectedLayer,\n            image: image\n        }\n        this.goodEvents.push(event)\n        this.undoEvents = []\n    }\n\n    dragImage(move: MouseMoveData) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x\n            lastImage.y = lastImage.y + move.y\n        }\n    }\n\n    nwResizeImage(move: MouseMoveData) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x\n            lastImage.y = lastImage.y + move.y\n            lastImage.width = lastImage.width - move.x\n            lastImage.height = lastImage.height - move.y\n        }\n    }\n\n    neResizeImage(move: MouseMoveData) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            // lastImage.x = lastImage.x + move.x;\n            lastImage.y = lastImage.y + move.y\n            lastImage.width = lastImage.width + move.x\n            lastImage.height = lastImage.height - move.y\n        }\n    }\n\n    seResizeImage(move: MouseMoveData) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            // lastImage.x = lastImage.x + move.x;\n            // lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width + move.x\n            lastImage.height = lastImage.height + move.y\n        }\n    }\n\n    swResizeImage(move: MouseMoveData) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x\n            // lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width - move.x\n            lastImage.height = lastImage.height + move.y\n        }\n    }\n\n    undo() {\n        if (this.goodEvents.length) {\n            this.undoEvents.push(this.goodEvents.pop()) // {}\n            this.undoEvents.push(this.goodEvents.pop()) // {type: 'line', point: [...], ...} or {type: 'image', image: {...}, ...}\n            this.goodEvents.push({type: null})\n        }\n    }\n\n    redo() {\n        if (this.undoEvents.length) {\n            this.goodEvents.pop()\n            this.goodEvents.push(this.undoEvents.pop()) // {type: 'line', point: [...], ...} or {type: 'image', image: {...}, ...}\n            this.goodEvents.push(this.undoEvents.pop()) // {}\n        }\n    }\n\n    clear() {\n        this.goodEvents = []\n        this.undoEvents = []\n    }\n}\n","import * as React from 'react'\n\nimport {ModeEnum, ResizeImageDirection} from './Constants'\nimport {EventStream} from './EventStream'\nimport {EventStore, PointData} from './EventStore'\n\n\ntype Props = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    mode: ModeEnum,\n    strokeWidth: number,\n    strokeColor: string\n}\n\ntype State = {\n    dragStart?: PointData,\n    resizeStart?: PointData\n}\n\nexport class CursorPane extends React.Component<Props, State> {\n\n    props: Props\n    state: State\n\n    dragHandle?: HTMLElement\n\n    constructor(props: Props) {\n        super(props)\n\n        this.state = {\n            dragStart: null,\n            resizeStart: null\n        }\n    }\n\n    onClickCursorLayer(ev: React.MouseEvent<HTMLDivElement>) {\n        let eventToPoint = (ev: React.MouseEvent<HTMLDivElement>): Array<number> => {\n            const x = ev.nativeEvent.offsetX - 2\n            const y = ev.nativeEvent.offsetY + (2 * (this.props.strokeWidth / 3))\n            return [x, y]\n        }\n\n        if (this.props.mode === ModeEnum.HAND) {\n            const [x, y] = eventToPoint(ev)\n            this.props.events.startDrawing(x, y)\n        } else {\n            this.props.events.stopDrawing()\n        }\n    }\n\n    onMouseMoveCursorLayer(ev: React.MouseEvent<HTMLDivElement>) {\n        let eventToPoint = (ev: React.MouseEvent<HTMLDivElement>): Array<number> => {\n            const x = ev.nativeEvent.offsetX - 2\n            const y = ev.nativeEvent.offsetY + (2 * (this.props.strokeWidth / 3))\n            return [x, y]\n        }\n\n        if (this.props.mode === ModeEnum.DRAW_LINE) {\n            const [x, y] = eventToPoint(ev)\n            this.props.events.pushPoint(x, y)\n        } else if (this.props.mode === ModeEnum.DRAG_IMAGE) {\n            if (ev.target !== this.dragHandle) {\n                return\n            }\n\n            const lastImage = this.props.eventStore.lastImage()\n            if (!lastImage) {\n                return\n            }\n\n            if (this.state.dragStart) {\n                const base = (lastImage.width < lastImage.height) ? lastImage.width : lastImage.height\n                const unit = (base / 8) < 20 ? Math.ceil(base / 8) : 20\n\n                const moveX = lastImage.x + unit < 0 ? ev.nativeEvent.offsetX - this.state.dragStart.x - (lastImage.x + unit) : ev.nativeEvent.offsetX - this.state.dragStart.x\n                const moveY = lastImage.y + unit < 0 ? ev.nativeEvent.offsetY - this.state.dragStart.y - (lastImage.y + unit) : ev.nativeEvent.offsetY - this.state.dragStart.y\n\n                this.props.events.dragImage(moveX, moveY)\n            }\n        } else if (this.props.mode === ModeEnum.NW_RESIZE_IMAGE || this.props.mode === ModeEnum.NE_RESIZE_IMAGE || this.props.mode === ModeEnum.SE_RESIZE_IMAGE || this.props.mode === ModeEnum.SW_RESIZE_IMAGE) {\n            const lastImage = this.props.eventStore.lastImage()\n            if (!lastImage) {\n                return\n            }\n\n            if (this.state.resizeStart) {\n                const moveX = ev.pageX - this.state.resizeStart.x\n                const moveY = ev.pageY - this.state.resizeStart.y\n\n                // do nothing if cannot resize image\n                if (this.props.mode === ModeEnum.NW_RESIZE_IMAGE && (lastImage.width - moveX < 0 || lastImage.height - moveY < 0)) {\n                    return\n                } else if (this.props.mode === ModeEnum.NE_RESIZE_IMAGE && (lastImage.width + moveX < 0 || lastImage.height - moveY < 0)) {\n                    return\n                } else if (this.props.mode === ModeEnum.SE_RESIZE_IMAGE && (lastImage.width + moveX < 0 || lastImage.height + moveY < 0)) {\n                    return\n                } else if (this.props.mode === ModeEnum.SW_RESIZE_IMAGE && (lastImage.width - moveX < 0 || lastImage.height + moveY < 0)) {\n                    return\n                }\n\n                this.setState({resizeStart: {x: ev.pageX, y: ev.pageY}})\n                this.props.events.resizeImage(moveX, moveY)\n            }\n        }\n    }\n\n    onClickDragHandle(ev: React.MouseEvent<HTMLDivElement>) {\n        if (this.props.mode === ModeEnum.HAND) {\n            this.setState({dragStart: {x: ev.nativeEvent.offsetX, y: ev.nativeEvent.offsetY}})\n            this.props.events.startDragging()\n        } else {\n            this.setState({dragStart: null})\n            this.props.events.stopDragging()\n        }\n        ev.preventDefault()\n        ev.stopPropagation()\n    }\n\n    onClickResizeHandle(direction: ResizeImageDirection, ev: React.MouseEvent<HTMLDivElement>) {\n        if (this.props.mode === ModeEnum.HAND) {\n            this.setState({resizeStart: {x: ev.pageX, y: ev.pageY}})\n            this.props.events.startResizing(direction)\n        } else {\n            this.setState({resizeStart: null})\n            this.props.events.stopResizing()\n        }\n        ev.preventDefault()\n        ev.stopPropagation()\n    }\n\n    render() {\n        const cursorLayerStyle = {\n            position: 'absolute' as 'absolute',\n            zIndex: 2000,\n            width: this.props.width,\n            height: this.props.height,\n            borderStyle: 'none none solid none',\n            borderColor: this.props.strokeColor\n        }\n\n        return (\n            <div role=\"presentation\" style={cursorLayerStyle}\n                 onClick={this.onClickCursorLayer.bind(this)} onMouseMove={this.onMouseMoveCursorLayer.bind(this)}>\n                {this.renderImageHandle()}\n            </div>\n        )\n    }\n\n    renderImageHandle(): Array<React.ComponentElement<any, any>> | undefined {\n        const lastImage = this.props.eventStore.lastImage()\n        if (!lastImage) {\n            return null\n        }\n\n        const base = (lastImage.width < lastImage.height) ? lastImage.width : lastImage.height\n        const unit = (base / 8) < 20 ? Math.ceil(base / 8) : 20\n\n        const mathMinOrMax = (min: number, max: number, value: number): number => {\n            if (value < min) {\n                return min\n            } else if (value > max) {\n                return max\n            } else {\n                return value\n            }\n        }\n\n        const top = mathMinOrMax(0, this.props.height, lastImage.y + unit)\n        const bottom = mathMinOrMax(0, this.props.height, lastImage.y + lastImage.height - unit)\n        const left = mathMinOrMax(0, this.props.width, lastImage.x + unit)\n        const right = mathMinOrMax(0, this.props.width, lastImage.x + lastImage.width - unit)\n\n        const dragHandleStyle = {\n            position: 'absolute' as 'absolute',\n            zIndex: 2500,\n            top: top,\n            left: left,\n            width: right - left,\n            height: bottom - top,\n            cursor: 'move'\n        }\n\n        const nwResizeHandleStyle = {\n            position: 'absolute' as 'absolute',\n            zIndex: 2500,\n            top: mathMinOrMax(0, this.props.height, top - unit),\n            left: mathMinOrMax(0, this.props.width, left - unit),\n            width: left - mathMinOrMax(0, this.props.width, left - unit),\n            height: top - mathMinOrMax(0, this.props.height, top - unit),\n            cursor: 'nw-resize'\n        }\n\n        const neResizeHandleStyle = {\n            position: 'absolute' as 'absolute',\n            zIndex: 2500,\n            top: mathMinOrMax(0, this.props.height, top - unit),\n            left: right,\n            width: mathMinOrMax(0, this.props.width, right + unit) - right,\n            height: top - mathMinOrMax(0, this.props.height, top - unit),\n            cursor: 'ne-resize'\n        }\n\n        const seResizeHandleStyle = {\n            position: 'absolute' as 'absolute',\n            zIndex: 2500,\n            top: bottom,\n            left: right,\n            width: mathMinOrMax(0, this.props.width, right + unit) - right,\n            height: mathMinOrMax(0, this.props.height, bottom + unit) - bottom,\n            cursor: 'se-resize'\n        }\n\n        const swResizeHandleStyle = {\n            position: 'absolute' as 'absolute',\n            zIndex: 2500,\n            top: bottom,\n            left: mathMinOrMax(0, this.props.width, left - unit),\n            width: left - mathMinOrMax(0, this.props.width, left - unit),\n            height: mathMinOrMax(0, this.props.height, bottom + unit) - bottom,\n            cursor: 'sw-resize'\n        }\n\n        return ([\n            <div key=\"drag\" role=\"presentation\" style={dragHandleStyle}\n                 ref={dragHandle => this.dragHandle = dragHandle} onClick={this.onClickDragHandle.bind(this)}/>,\n            <div key=\"nw-resize\" role=\"presentation\" style={nwResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, ModeEnum.NW_RESIZE_IMAGE)}/>,\n            <div key=\"ne-resize\" role=\"presentation\" style={neResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, ModeEnum.NE_RESIZE_IMAGE)}/>,\n            <div key=\"se-resize\" role=\"presentation\" style={seResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, ModeEnum.SE_RESIZE_IMAGE)}/>,\n            <div key=\"sw-resize\" role=\"presentation\" style={swResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, ModeEnum.SW_RESIZE_IMAGE)}/>\n        ])\n    }\n}\n","import * as React from 'react'\n\nimport {AnyReducedEvent, EventStore, ImageData, isReducedImageEvent, isReducedLineEvent, PointData} from './EventStore'\n\n\ntype Props = {\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n}\n\ntype State = {}\n\nexport class CanvasPane extends React.Component<Props, State> {\n\n    props: Props\n    state: State\n\n    svgElement?: SVGSVGElement\n\n    constructor(props: Props) {\n        super(props)\n\n        this.svgElement = null\n    }\n\n    getSvgElement(): SVGSVGElement | undefined {\n        return this.svgElement\n    }\n\n    render() {\n        const canvasLayerStyle = {\n            position: 'absolute' as 'absolute',\n            width: this.props.width,\n            height: this.props.height\n        }\n\n        return (\n            <div style={canvasLayerStyle}>\n                <svg ref={element => this.svgElement = element}\n                     version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n                     width={this.props.width} height={this.props.height}>\n                    <rect width={'100%'} height={'100%'} fill={this.props.style.backgroundColor}/>\n                    {this.drawWhiteboardCanvas()}\n                    {this.drawImageBorder()}\n                </svg>\n            </div>\n        )\n    }\n\n    drawWhiteboardCanvas(): Array<React.ComponentElement<any, any> | undefined> {\n        return this.props.eventStore.reduceEvents().map((element: AnyReducedEvent, index: number): React.ComponentElement<any, any> | undefined => {\n            if (isReducedLineEvent(element)) {\n                const key = index\n                const d = element.values.map((point: PointData, index: number) => {\n                    if (index === 0) {\n                        return 'M ' + point.x + ' ' + point.y\n                    } else {\n                        return 'L ' + point.x + ' ' + point.y\n                    }\n                })\n\n                return (\n                    <path key={key} d={d.join(' ')} fill=\"none\" stroke={element.strokeColor} strokeWidth={element.strokeWidth}/>\n                )\n\n            } else if (isReducedImageEvent(element)) {\n                const key = index\n                const image: ImageData = element.image\n\n                return (\n                    <image key={key} x={image.x} y={image.y} width={image.width} height={image.height} xlinkHref={image.dataUrl}/>\n                )\n\n            } else {\n                return null\n            }\n        })\n    }\n\n    drawImageBorder(): React.ComponentElement<any, any> | undefined {\n        const lastImage = this.props.eventStore.lastImage()\n        if (!lastImage) {\n            return null\n        }\n\n        return (\n            <rect x={lastImage.x} y={lastImage.y} width={lastImage.width} height={lastImage.height}\n                  fill={'none'} stroke={'black'} strokeDasharray={'5,5'}/>\n        )\n    }\n}\n","import * as React from 'react'\n\nimport {ModeEnum, ResizeImageDirection} from './Constants'\nimport {ChangeStrokeColor, ChangeStrokeWidth, EventNameEnum, EventStream} from './EventStream'\nimport {EventStore, ImageData, MouseMoveData, PointData} from './EventStore'\nimport {CursorPane} from './CursorPane'\nimport {CanvasPane} from './CanvasPane'\n\n\ntype Props = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n}\n\ntype State = {\n    eventStore: EventStore,\n    mode: ModeEnum,\n    layer: number,\n    strokeWidth: number,\n    strokeColor: string\n}\n\nexport class Whiteboard extends React.Component<Props, State> {\n\n    static defaultProps = {\n        events: new EventStream(),\n        eventStore: new EventStore(),\n        width: 400,\n        height: 400,\n        style: {\n            backgroundColor: 'none'\n        }\n    }\n    props: Props\n    state: State\n\n    canvas?: CanvasPane\n\n    constructor(props: Props) {\n        super(props)\n\n        this.state = {\n            eventStore: props.eventStore,\n            mode: ModeEnum.HAND,\n            layer: 0,\n            strokeWidth: 5,\n            strokeColor: 'black'\n        }\n\n        this.canvas = null\n    }\n\n    getSvgElement(): SVGSVGElement | undefined {\n        if (this.canvas) {\n            return this.canvas.getSvgElement()\n        }\n    }\n\n    componentDidMount() {\n        this.setupEventHandler()\n    }\n\n    setupEventHandler() {\n        this.props.events.on(EventNameEnum.SELECT_LAYER, this.selectLayer.bind(this))\n        this.props.events.on(EventNameEnum.ADD_LAYER, this.addLayer.bind(this))\n\n        this.props.events.on(EventNameEnum.START, this.startDrawing.bind(this))\n        this.props.events.on(EventNameEnum.STOP, this.stopDrawing.bind(this))\n\n        this.props.events.on(EventNameEnum.SET, (event: ChangeStrokeWidth | ChangeStrokeColor) => {\n            if (event.key === 'strokeWidth') {\n                this.changeStrokeWidth(event.value)\n            }\n            if (event.key === 'strokeColor') {\n                this.changeStrokeColor(event.value)\n            }\n        })\n\n        this.props.events.on(EventNameEnum.PUSH, this.pushPoint.bind(this))\n\n        this.props.events.on(EventNameEnum.PASTE, this.pasteImage.bind(this))\n        this.props.events.on(EventNameEnum.START_DRAGGING, this.startDragging.bind(this))\n        this.props.events.on(EventNameEnum.STOP_DRAGGING, this.stopDragging.bind(this))\n        this.props.events.on(EventNameEnum.DRAG, this.dragImage.bind(this))\n        this.props.events.on(EventNameEnum.START_RESIZING, this.startResizing.bind(this))\n        this.props.events.on(EventNameEnum.STOP_RESIZING, this.stopResizing.bind(this))\n        this.props.events.on(EventNameEnum.RESIZE, this.resizeImage.bind(this))\n\n        this.props.events.on(EventNameEnum.UNDO, this.undo.bind(this))\n        this.props.events.on(EventNameEnum.REDO, this.redo.bind(this))\n        this.props.events.on(EventNameEnum.CLEAR, this.clear.bind(this))\n    }\n\n    selectLayer(layer: number) {\n        this.state.eventStore.selectLayer(layer)\n        this.setState({\n            layer: layer,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    addLayer() {\n        this.state.eventStore.addLayer()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    startDrawing(point: PointData) {\n        this.state.eventStore.startDrawing(this.state.strokeWidth, this.state.strokeColor, point)\n        this.setState({\n            mode: ModeEnum.DRAW_LINE,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    stopDrawing() {\n        this.state.eventStore.stopDrawing()\n        this.setState({\n            mode: ModeEnum.HAND,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    changeStrokeWidth(width: number) {\n        this.state.eventStore.stopDrawing()\n        this.setState({\n            strokeWidth: width,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    changeStrokeColor(color: string) {\n        this.state.eventStore.stopDrawing()\n        this.setState({\n            strokeColor: color,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    pushPoint(point: PointData) {\n        this.state.eventStore.pushPoint(this.state.strokeWidth, this.state.strokeColor, point)\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    pasteImage(image: ImageData) {\n        this.state.eventStore.pasteImage(image)\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    startDragging() {\n        this.setState({mode: ModeEnum.DRAG_IMAGE})\n    }\n\n    stopDragging() {\n        this.setState({mode: ModeEnum.HAND})\n    }\n\n    dragImage(move: MouseMoveData) {\n        if (this.state.mode !== ModeEnum.DRAG_IMAGE) {\n            return\n        }\n\n        this.state.eventStore.dragImage(move)\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    startResizing(direction: ResizeImageDirection) {\n        this.setState({mode: direction})\n    }\n\n    stopResizing() {\n        this.setState({mode: ModeEnum.HAND})\n    }\n\n    resizeImage(move: MouseMoveData) {\n        if (this.state.mode === ModeEnum.NW_RESIZE_IMAGE) {\n            this.state.eventStore.nwResizeImage(move)\n            this.setState({eventStore: this.state.eventStore})\n        } else if (this.state.mode === ModeEnum.NE_RESIZE_IMAGE) {\n            this.state.eventStore.neResizeImage(move)\n            this.setState({eventStore: this.state.eventStore})\n        } else if (this.state.mode === ModeEnum.SE_RESIZE_IMAGE) {\n            this.state.eventStore.seResizeImage(move)\n            this.setState({eventStore: this.state.eventStore})\n        } else if (this.state.mode === ModeEnum.SW_RESIZE_IMAGE) {\n            this.state.eventStore.swResizeImage(move)\n            this.setState({eventStore: this.state.eventStore})\n        }\n    }\n\n    undo() {\n        this.state.eventStore.undo()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    redo() {\n        this.state.eventStore.redo()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    clear() {\n        this.state.eventStore.clear()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    render() {\n        const wrapperStyle = {\n            position: 'relative' as 'relative',\n            width: this.props.width,\n            height: this.props.height\n        }\n\n        const props = {...this.props, ...this.state}\n\n        return (\n            <div style={wrapperStyle}>\n                <CursorPane {...props}/>\n                <CanvasPane ref={canvas => this.canvas = canvas} {...props}/>\n            </div>\n        )\n    }\n}\n","import {ImageData} from './EventStore'\n\n\nexport class SvgConverter {\n\n    static toSvgData(sourceNode: SVGSVGElement): Promise<string> {\n        let htmlText = sourceNode.outerHTML\n        let base64EncodedText = window.btoa(\n            window.encodeURIComponent(htmlText)\n                .replace(/%([0-9A-F]{2})/g, (match: string, p1: string): string => String.fromCharCode(window.parseInt('0x' + p1))))\n\n        return new Promise(resolve => {\n            resolve('data:image/svg+xml;charset=utf-8;base64,' + base64EncodedText)\n        })\n    }\n\n    static toPngData(sourceNode: SVGSVGElement): Promise<string> {\n        return SvgConverter.toDataUrl(sourceNode, 'image/png')\n    }\n\n    static toJpegData(sourceNode: SVGSVGElement): Promise<string> {\n        return SvgConverter.toDataUrl(sourceNode, 'image/jpeg')\n    }\n\n    static toDataUrl(sourceNode: SVGSVGElement, imageType: string): Promise<string> {\n        return new Promise(resolve => {\n            SvgConverter.toSvgData(sourceNode).then((svgdata: string) => {\n                let {width, height} = sourceNode.getBoundingClientRect()\n\n                let imageNode = new window.Image()\n                imageNode.onload = () => {\n                    let canvasNode = document.createElement('canvas')\n                    canvasNode.width = width\n                    canvasNode.height = height\n\n                    let graphicsContext = canvasNode.getContext('2d')\n                    if (graphicsContext) {\n                        graphicsContext.drawImage(imageNode, 0, 0)\n                    } else {\n                        throw new Error('got no rendering context')\n                    }\n\n                    resolve(canvasNode.toDataURL(imageType))\n                }\n                imageNode.src = svgdata\n            })\n        })\n    }\n\n    static fromPngImage(imageUrl: string): Promise<ImageData> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/png')\n    }\n\n    static fromJpegImage(imageUrl: string): Promise<ImageData> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/jpeg')\n    }\n\n    static fromGifImage(imageUrl: string): Promise<ImageData> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/gif')\n    }\n\n    static fromImageUrl(imageUrl: string, imageType: string): Promise<ImageData> {\n        return new Promise(resolve => {\n            let imageNode = new window.Image()\n            imageNode.onload = () => {\n                let canvasNode = document.createElement('canvas')\n                canvasNode.width = imageNode.width\n                canvasNode.height = imageNode.height\n\n                let graphicsContext = canvasNode.getContext('2d')\n                if (graphicsContext) {\n                    graphicsContext.drawImage(imageNode, 0, 0)\n                } else {\n                    throw new Error('got no rendering context')\n                }\n\n                resolve({width: imageNode.width, height: imageNode.height, dataUrl: canvasNode.toDataURL(imageType)})\n            }\n            imageNode.crossOrigin = 'anonymous'\n            imageNode.src = imageUrl\n        })\n    }\n}\n","import {ModeEnum, SvgElementEnum} from './Constants'\n\nexport {Whiteboard} from './Whiteboard'\nexport {ChangeStrokeColor, ChangeStrokeWidth, EventListener, EventNameEnum, EventStream, EventStreamProtocol} from './EventStream'\nexport {\n    EventStore,\n    EventStoreProtocol,\n    ImageData,\n    ImageEvent,\n    isPointEvent,\n    isImageEvent,\n    isReducedImageEvent,\n    isReducedLineEvent,\n    MouseMoveData,\n    PointData,\n    PointEvent,\n    StopEvent\n} from './EventStore'\nexport {SvgConverter} from './SvgConverter'\nexport {ModeEnum, SvgElementEnum}\n"],"sourceRoot":""}